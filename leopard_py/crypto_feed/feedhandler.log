2022-12-25 14:55:30,468 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 14, in ticker
    redisConnect.set_str(t.symbol, t.ask)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 17, in set_str
    self.conn.set(key, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2238, in set
    return self.execute_command("SET", *pieces, **options)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 14:55:32,311 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 14, in ticker
    redisConnect.set_str(t.symbol, t.ask)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 17, in set_str
    self.conn.set(key, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2238, in set
    return self.execute_command("SET", *pieces, **options)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 14:55:34,402 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 14, in ticker
    redisConnect.set_str(t.symbol, t.ask)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 17, in set_str
    self.conn.set(key, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2238, in set
    return self.execute_command("SET", *pieces, **options)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 14:55:36,400 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 14, in ticker
    redisConnect.set_str(t.symbol, t.ask)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 17, in set_str
    self.conn.set(key, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2238, in set
    return self.execute_command("SET", *pieces, **options)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 14:55:38,347 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 14, in ticker
    redisConnect.set_str(t.symbol, t.ask)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 17, in set_str
    self.conn.set(key, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2238, in set
    return self.execute_command("SET", *pieces, **options)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 14:55:40,394 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 14, in ticker
    redisConnect.set_str(t.symbol, t.ask)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 17, in set_str
    self.conn.set(key, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2238, in set
    return self.execute_command("SET", *pieces, **options)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 14:56:06,283 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 14, in ticker
    redisConnect.set_str(t.symbol, t.ask)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 17, in set_str
    self.conn.set(key, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2238, in set
    return self.execute_command("SET", *pieces, **options)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 14:56:08,563 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 14, in ticker
    redisConnect.set_str(t.symbol, t.ask)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 17, in set_str
    self.conn.set(key, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2238, in set
    return self.execute_command("SET", *pieces, **options)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 14:59:47,440 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 16, in ticker
    print('key:', item, ',value:', Constants.market_warning_config[item])
TypeError: tuple indices must be integers or slices, not dict
2022-12-25 14:59:49,432 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 16, in ticker
    print('key:', item, ',value:', Constants.market_warning_config[item])
TypeError: tuple indices must be integers or slices, not dict
2022-12-25 15:00:11,558 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 17, in ticker
    print('key:', item, ',value:', Constants.market_warning_config[item])
TypeError: tuple indices must be integers or slices, not dict
2022-12-25 15:00:14,563 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 17, in ticker
    print('key:', item, ',value:', Constants.market_warning_config[item])
TypeError: tuple indices must be integers or slices, not dict
2022-12-25 15:11:33,206 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 20, in ticker
    market = item["market"]
TypeError: string indices must be integers
2022-12-25 15:12:20,840 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 19, in ticker
    if "market" in market_warning.keys:
TypeError: argument of type 'builtin_function_or_method' is not iterable
2022-12-25 15:16:15,412 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 20, in ticker
    market = item["market"]
TypeError: string indices must be integers
2022-12-25 15:16:17,291 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 20, in ticker
    market = item["market"]
TypeError: string indices must be integers
2022-12-25 15:16:19,265 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 20, in ticker
    market = item["market"]
TypeError: string indices must be integers
2022-12-25 15:16:21,355 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 20, in ticker
    market = item["market"]
TypeError: string indices must be integers
2022-12-25 15:16:23,404 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 20, in ticker
    market = item["market"]
TypeError: string indices must be integers
2022-12-25 15:16:25,526 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 20, in ticker
    market = item["market"]
TypeError: string indices must be integers
2022-12-25 15:31:01,369 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    if market_value.isspace() or len(market_value) == 0:
AttributeError: 'NoneType' object has no attribute 'isspace'
2022-12-25 15:31:03,511 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    if market_value.isspace() or len(market_value) == 0:
AttributeError: 'NoneType' object has no attribute 'isspace'
2022-12-25 15:31:05,253 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    if market_value.isspace() or len(market_value) == 0:
AttributeError: 'NoneType' object has no attribute 'isspace'
2022-12-25 15:31:07,481 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    if market_value.isspace() or len(market_value) == 0:
AttributeError: 'NoneType' object has no attribute 'isspace'
2022-12-25 15:32:39,321 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 26, in ticker
    if market_value.isspace() or len(market_value) == 0:
AttributeError: 'NoneType' object has no attribute 'isspace'
2022-12-25 15:34:16,719 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, str(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.set(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2207, in set
    raise DataError("ex must be datetime.timedelta or int")
redis.exceptions.DataError: ex must be datetime.timedelta or int
2022-12-25 15:34:56,347 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, str(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.set(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2207, in set
    raise DataError("ex must be datetime.timedelta or int")
redis.exceptions.DataError: ex must be datetime.timedelta or int
2022-12-25 15:42:08,705 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    change_percent = round((t.ask - float(market_value)) / float(market_value), 4) * 100
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:42:10,316 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    change_percent = round((t.ask - float(market_value)) / float(market_value), 4) * 100
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:42:12,355 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    change_percent = round((t.ask - float(market_value)) / float(market_value), 4) * 100
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:42:14,400 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    change_percent = round((t.ask - float(market_value)) / float(market_value), 4) * 100
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:42:48,279 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    change_percent = round((t.ask - float(market_value)) / float(market_value), 4) * 100
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:42:50,350 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    change_percent = round((t.ask - float(market_value)) / float(market_value), 4) * 100
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:43:14,256 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:43:16,456 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:43:18,400 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:43:49,271 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:43:51,476 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:43:53,530 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:43:55,552 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:43:57,424 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:43:59,308 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:44:01,310 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:44:03,457 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:44:05,402 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:44:07,407 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:44:09,292 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:44:11,554 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:44:13,284 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:44:15,338 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:17,307 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:19,373 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:22,557 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:24,549 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:26,548 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:30,383 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:32,329 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:34,381 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:36,551 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:38,376 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:40,257 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:42,372 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:44,532 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:46,387 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, Decimal(t.ask), int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:49,374 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, t.ask, int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:51,547 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, t.ask, int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:53,276 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, t.ask, int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:44:55,271 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, t.ask, int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Decimal'. Convert to a bytes, string, int or float first.
2022-12-25 15:47:18,336 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 32, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:47:20,399 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 32, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:47:29,380 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 32, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 15:47:31,434 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 32, in ticker
    print(t.ask - float(market_value))
TypeError: unsupported operand type(s) for -: 'decimal.Decimal' and 'float'
2022-12-25 16:15:45,582 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, market_warning, int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:15:47,389 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, market_warning, int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:15:49,390 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, market_warning, int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:15:51,222 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 27, in ticker
    redisConnect.set_str(market_key, market_warning, int(market_warning[item]) * 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 19, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:12,398 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:14,254 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:16,286 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:18,526 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:20,362 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:22,244 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:24,380 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:26,264 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:28,296 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:30,517 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:32,535 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:34,398 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:36,307 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:38,369 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:40,529 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:42,298 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:44,382 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:46,369 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:48,246 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:50,354 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:53,249 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:55,371 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:57,296 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:25:59,350 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:26:01,234 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:26:03,238 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:26:16,456 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:26:33,909 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:27:09,842 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 52, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:27:48,537 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, params, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:27:50,351 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, params, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:27:52,509 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, params, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:27:54,503 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, params, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:27:56,396 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, params, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:28:16,358 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, params, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:28:18,519 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, params, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:28:20,316 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, params, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:28:22,267 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, params, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:28:24,456 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, params, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:28:26,389 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, params, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:28:28,337 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, params, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:29:17,245 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:29:19,237 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:29:21,372 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:29:23,373 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:29:25,233 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:29:27,379 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:29:29,350 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:29:31,278 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:29:33,260 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:29:35,307 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.insert_hash_mapping(market, market, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:29:38,388 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:29:40,335 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:29:42,386 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:29:44,316 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:29:46,515 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:29:48,415 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:29:50,377 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:29:52,378 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:29:56,406 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:29:58,521 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:00,396 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:02,363 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:04,394 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:06,248 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:10,436 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:12,340 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:14,425 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:16,291 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:18,250 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:20,385 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:22,309 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:24,263 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:26,516 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:28,235 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:30,521 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:32,378 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:34,394 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:36,283 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:38,534 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:40,339 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:42,384 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:44,313 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:46,377 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:50,366 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:52,316 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:54,390 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:56,414 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:30:58,345 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:31:00,348 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:31:02,344 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:31:04,531 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:31:06,509 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:31:08,315 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:31:10,327 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:31:12,517 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:31:14,309 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:31:16,383 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:31:18,291 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:31:20,377 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:31:22,319 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dump(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:31:24,369 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dumps(market_warning))
TypeError: dump() missing 1 required positional argument: 'fp'
2022-12-25 16:31:26,370 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dumps(market_warning))
TypeError: insert_hash_mapping() takes 3 positional arguments but 4 were given
2022-12-25 16:31:28,225 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dumps(market_warning))
TypeError: insert_hash_mapping() takes 3 positional arguments but 4 were given
2022-12-25 16:31:30,245 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dumps(market_warning))
TypeError: insert_hash_mapping() takes 3 positional arguments but 4 were given
2022-12-25 16:31:32,219 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dumps(market_warning))
TypeError: insert_hash_mapping() takes 3 positional arguments but 4 were given
2022-12-25 16:31:34,534 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dumps(market_warning))
TypeError: insert_hash_mapping() takes 3 positional arguments but 4 were given
2022-12-25 16:33:51,417 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:33:53,468 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:33:55,520 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:33:57,350 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:33:59,280 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:01,453 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:03,508 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:05,445 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:07,279 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:09,496 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:11,514 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:13,249 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:15,380 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:17,244 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:19,504 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:21,507 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:23,470 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:25,308 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:27,533 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:29,407 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:31,362 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:34,531 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:36,366 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:38,276 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:40,287 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:42,337 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:44,526 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:46,412 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:48,351 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:50,514 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:52,525 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:54,238 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:56,350 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:34:58,392 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:35:00,511 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:35:02,380 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:35:04,429 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, market_warning)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:35:06,368 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dumps(market_warning))
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 56, in insert_hash_mapping
    self.conn.hset(key, name, mapping)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'dict'. Convert to a bytes, string, int or float first.
2022-12-25 16:36:58,409 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(redisConnect.get_hash_mapping(market, market_key))
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 59, in get_hash_mapping
    return json.loads(self.conn.hget(key, name))
NameError: name 'json' is not defined
2022-12-25 16:37:00,368 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(redisConnect.get_hash_mapping(market, market_key))
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 59, in get_hash_mapping
    return json.loads(self.conn.hget(key, name))
NameError: name 'json' is not defined
2022-12-25 16:37:02,229 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(redisConnect.get_hash_mapping(market, market_key))
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 59, in get_hash_mapping
    return json.loads(self.conn.hget(key, name))
NameError: name 'json' is not defined
2022-12-25 16:37:04,284 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(redisConnect.get_hash_mapping(market, market_key))
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 59, in get_hash_mapping
    return json.loads(self.conn.hget(key, name))
NameError: name 'json' is not defined
2022-12-25 16:37:06,288 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(redisConnect.get_hash_mapping(market, market_key))
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 59, in get_hash_mapping
    return json.loads(self.conn.hget(key, name))
NameError: name 'json' is not defined
2022-12-25 16:37:08,332 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(redisConnect.get_hash_mapping(market, market_key))
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 59, in get_hash_mapping
    return json.loads(self.conn.hget(key, name))
NameError: name 'json' is not defined
2022-12-25 16:37:10,506 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(redisConnect.get_hash_mapping(market, market_key))
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 59, in get_hash_mapping
    return json.loads(self.conn.hget(key, name))
NameError: name 'json' is not defined
2022-12-25 16:37:12,351 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(redisConnect.get_hash_mapping(market, market_key))
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 59, in get_hash_mapping
    return json.loads(self.conn.hget(key, name))
NameError: name 'json' is not defined
2022-12-25 16:37:14,524 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(redisConnect.get_hash_mapping(market, market_key))
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 59, in get_hash_mapping
    return json.loads(self.conn.hget(key, name))
NameError: name 'json' is not defined
2022-12-25 16:37:16,503 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(redisConnect.get_hash_mapping(market, market_key))
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 59, in get_hash_mapping
    return json.loads(self.conn.hget(key, name))
NameError: name 'json' is not defined
2022-12-25 16:37:18,519 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(redisConnect.get_hash_mapping(market, market_key))
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 59, in get_hash_mapping
    return json.loads(self.conn.hget(key, name))
NameError: name 'json' is not defined
2022-12-25 16:37:20,294 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(redisConnect.get_hash_mapping(market, market_key))
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 59, in get_hash_mapping
    return json.loads(self.conn.hget(key, name))
NameError: name 'json' is not defined
2022-12-25 16:37:58,344 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dumps(t))
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Ticker is not JSON serializable
2022-12-25 16:38:00,500 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dumps(t))
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Ticker is not JSON serializable
2022-12-25 16:38:02,399 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dumps(t))
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Ticker is not JSON serializable
2022-12-25 16:38:04,281 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash_mapping(market, market_key, json.dumps(t))
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Ticker is not JSON serializable
2022-12-25 16:39:01,373 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash(market, market_key, t)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 53, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Ticker'. Convert to a bytes, string, int or float first.
2022-12-25 16:39:03,333 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash(market, market_key, t)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 53, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Ticker'. Convert to a bytes, string, int or float first.
2022-12-25 16:39:05,515 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.insert_hash(market, market_key, t)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 53, in insert_hash
    self.conn.hset(key, params, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 4859, in hset
    return self.execute_command("HSET", name, *items)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Ticker'. Convert to a bytes, string, int or float first.
2022-12-25 16:41:11,329 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.set_str(market_key, t)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 18, in set_str
    self.conn.setex(key, value)
TypeError: setex() missing 1 required positional argument: 'value'
2022-12-25 16:41:13,376 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.set_str(market_key, t)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 18, in set_str
    self.conn.setex(key, value)
TypeError: setex() missing 1 required positional argument: 'value'
2022-12-25 16:41:15,331 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.set_str(market_key, t)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 18, in set_str
    self.conn.setex(key, value)
TypeError: setex() missing 1 required positional argument: 'value'
2022-12-25 16:41:17,231 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.set_str(market_key, t)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 18, in set_str
    self.conn.setex(key, value)
TypeError: setex() missing 1 required positional argument: 'value'
2022-12-25 16:41:19,341 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 29, in ticker
    redisConnect.set_str(market_key, t)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 18, in set_str
    self.conn.setex(key, value)
TypeError: setex() missing 1 required positional argument: 'value'
2022-12-25 16:41:43,508 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.set_str(market_key, t, 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 20, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Ticker'. Convert to a bytes, string, int or float first.
2022-12-25 16:41:45,323 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.set_str(market_key, t, 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 20, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Ticker'. Convert to a bytes, string, int or float first.
2022-12-25 16:41:47,343 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    redisConnect.set_str(market_key, t, 60)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 20, in set_str
    self.conn.setex(key, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/commands/core.py", line 2263, in setex
    return self.execute_command("SETEX", name, time, value)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1258, in execute_command
    return conn.retry.call_with_retry(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1259, in <lambda>
    lambda: self._send_command_parse_response(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/client.py", line 1234, in _send_command_parse_response
    conn.send_command(*args)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 788, in send_command
    self.pack_command(*args), check_health=kwargs.get("check_health", True)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 846, in pack_command
    for arg in map(self.encoder.encode, args):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/redis/connection.py", line 107, in encode
    raise DataError(
redis.exceptions.DataError: Invalid input of type: 'Ticker'. Convert to a bytes, string, int or float first.
2022-12-25 16:43:04,282 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(pickle.loads(redisConnect.get_str(market_key)))
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 26, in get_str
    value = str(value, encoding='utf8')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
2022-12-25 16:43:06,430 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 26, in ticker
    market_value = redisConnect.get_str(market_key)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 26, in get_str
    value = str(value, encoding='utf8')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
2022-12-25 16:43:08,479 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 26, in ticker
    market_value = redisConnect.get_str(market_key)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 26, in get_str
    value = str(value, encoding='utf8')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
2022-12-25 16:44:23,536 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 26, in ticker
    market_value = redisConnect.get_str(market_key)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 25, in get_str
    value = str(value, encoding='utf8')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
2022-12-25 16:44:25,394 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 26, in ticker
    market_value = redisConnect.get_str(market_key)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 25, in get_str
    value = str(value, encoding='utf8')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
2022-12-25 16:44:27,396 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 26, in ticker
    market_value = redisConnect.get_str(market_key)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 25, in get_str
    value = str(value, encoding='utf8')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
2022-12-25 16:44:29,360 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 26, in ticker
    market_value = redisConnect.get_str(market_key)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 25, in get_str
    value = str(value, encoding='utf8')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
2022-12-25 16:44:31,329 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 26, in ticker
    market_value = redisConnect.get_str(market_key)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 25, in get_str
    value = str(value, encoding='utf8')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
2022-12-25 16:44:33,247 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 26, in ticker
    market_value = redisConnect.get_str(market_key)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 25, in get_str
    value = str(value, encoding='utf8')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
2022-12-25 16:44:37,356 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 26, in ticker
    market_value = redisConnect.get_str(market_key)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 25, in get_str
    value = str(value, encoding='utf8')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
2022-12-25 16:44:39,283 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 26, in ticker
    market_value = redisConnect.get_str(market_key)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 25, in get_str
    value = str(value, encoding='utf8')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
2022-12-25 16:46:40,464 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 26, in ticker
    market_value = redisConnect.get_str_pickle(market_key)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 41, in get_str_pickle
    return pickle.loads(self.conn.get(key))
TypeError: a bytes-like object is required, not 'NoneType'
2022-12-25 16:46:42,380 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 26, in ticker
    market_value = redisConnect.get_str_pickle(market_key)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/utils/RedisHelper.py", line 41, in get_str_pickle
    return pickle.loads(self.conn.get(key))
TypeError: a bytes-like object is required, not 'NoneType'
2022-12-25 16:47:18,310 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(pickle.loads(redisConnect.get_str_pickle(market_key)))
TypeError: a bytes-like object is required, not 'cryptofeed.types.Ticker'
2022-12-25 16:47:20,294 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    if market_value.isspace() or len(market_value) == 0:
AttributeError: 'cryptofeed.types.Ticker' object has no attribute 'isspace'
2022-12-25 16:47:22,398 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    if market_value.isspace() or len(market_value) == 0:
AttributeError: 'cryptofeed.types.Ticker' object has no attribute 'isspace'
2022-12-25 16:47:24,523 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    if market_value.isspace() or len(market_value) == 0:
AttributeError: 'cryptofeed.types.Ticker' object has no attribute 'isspace'
2022-12-25 16:50:55,831 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(pickle.loads(redisConnect.get_str_pickle(market_key)))
TypeError: a bytes-like object is required, not 'cryptofeed.types.Ticker'
2022-12-25 16:51:21,048 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    if len(market_value) == 0:
TypeError: object of type 'cryptofeed.types.Ticker' has no len()
2022-12-25 16:51:22,535 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    if len(market_value) == 0:
TypeError: object of type 'cryptofeed.types.Ticker' has no len()
2022-12-25 16:51:24,313 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    if len(market_value) == 0:
TypeError: object of type 'cryptofeed.types.Ticker' has no len()
2022-12-25 16:51:26,373 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    if len(market_value) == 0:
TypeError: object of type 'cryptofeed.types.Ticker' has no len()
2022-12-25 16:52:19,365 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(pickle.loads(redisConnect.get_str_pickle(market_key)))
TypeError: a bytes-like object is required, not 'cryptofeed.types.Ticker'
2022-12-25 16:53:32,424 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(pickle.loads(redisConnect.get_str_pickle(market_key)))
TypeError: a bytes-like object is required, not 'cryptofeed.types.Ticker'
2022-12-25 16:53:34,373 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(pickle.loads(redisConnect.get_str_pickle(market_key)))
TypeError: a bytes-like object is required, not 'cryptofeed.types.Ticker'
2022-12-25 16:54:48,299 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(pickle.loads(redisConnect.get_str_pickle(market_key)))
TypeError: a bytes-like object is required, not 'cryptofeed.types.Ticker'
2022-12-25 16:54:52,883 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 30, in ticker
    print(pickle.loads(redisConnect.get_str_pickle(market_key)))
TypeError: a bytes-like object is required, not 'cryptofeed.types.Ticker'
2022-12-25 16:56:12,574 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    if market_value.isspace() or len(market_value) == 0:
AttributeError: 'cryptofeed.types.Ticker' object has no attribute 'isspace'
2022-12-25 16:56:14,327 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 28, in ticker
    if market_value.isspace() or len(market_value) == 0:
AttributeError: 'cryptofeed.types.Ticker' object has no attribute 'isspace'
2022-12-25 17:03:43,292 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 19, in ticker
    print(t.price)
AttributeError: 'cryptofeed.types.Ticker' object has no attribute 'price'
2022-12-25 17:03:45,437 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 19, in ticker
    print(t.price)
AttributeError: 'cryptofeed.types.Ticker' object has no attribute 'price'
2022-12-25 17:03:47,272 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 19, in ticker
    print(t.price)
AttributeError: 'cryptofeed.types.Ticker' object has no attribute 'price'
2022-12-25 17:07:17,300 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 33, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'NoneType' and 'NoneType'
2022-12-25 17:07:19,354 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 33, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'NoneType' and 'NoneType'
2022-12-25 17:07:21,557 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 33, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'NoneType' and 'NoneType'
2022-12-25 17:07:23,428 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 33, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'NoneType' and 'NoneType'
2022-12-25 17:10:22,579 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:10:24,564 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:10:26,561 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:10:28,487 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:10:30,406 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:10:32,479 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:10:34,390 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:10:36,471 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:10:38,422 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:10:40,547 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:10:42,319 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:10:44,563 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:10:46,467 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:10:48,454 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:10:50,546 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 35, in ticker
    change_percent = round((current_price - last_price) / last_price, 4) * 100
TypeError: unsupported operand type(s) for -: 'str' and 'str'
2022-12-25 17:36:07,532 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 19, in ticker
    receipt_timestamp = t.raw["'time_ms'"]
KeyError: "'time_ms'"
2022-12-25 17:36:09,399 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 19, in ticker
    receipt_timestamp = t.raw["'time_ms'"]
KeyError: "'time_ms'"
2022-12-25 17:36:11,347 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 19, in ticker
    receipt_timestamp = t.raw["'time_ms'"]
KeyError: "'time_ms'"
2022-12-25 17:36:13,395 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 19, in ticker
    receipt_timestamp = t.raw["'time_ms'"]
KeyError: "'time_ms'"
2022-12-25 17:36:15,342 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 19, in ticker
    receipt_timestamp = t.raw["'time_ms'"]
KeyError: "'time_ms'"
2022-12-25 17:36:17,291 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 19, in ticker
    receipt_timestamp = t.raw["'time_ms'"]
KeyError: "'time_ms'"
2022-12-25 17:36:19,336 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 19, in ticker
    receipt_timestamp = t.raw["'time_ms'"]
KeyError: "'time_ms'"
2022-12-25 17:48:32,266 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 23, in ticker
    todayChangePercent = Decimal(t.raw["result"]["'change_percentage'"])
KeyError: "'change_percentage'"
2022-12-25 17:48:34,415 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 23, in ticker
    todayChangePercent = Decimal(t.raw["result"]["'change_percentage'"])
KeyError: "'change_percentage'"
2022-12-25 17:48:36,439 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 23, in ticker
    todayChangePercent = Decimal(t.raw["result"]["'change_percentage'"])
KeyError: "'change_percentage'"
2022-12-25 17:48:38,266 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 23, in ticker
    todayChangePercent = Decimal(t.raw["result"]["'change_percentage'"])
KeyError: "'change_percentage'"
2022-12-25 17:48:40,317 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 23, in ticker
    todayChangePercent = Decimal(t.raw["result"]["'change_percentage'"])
KeyError: "'change_percentage'"
2022-12-25 17:48:42,481 : ERROR : GATEIO.ws.1: encountered an exception, reconnecting in 1.0 seconds
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 119, in _handler
    await handler(message, connection, self.conn.last_message)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 246, in message_handler
    await self._ticker(msg, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/exchanges/gateio.py", line 84, in _ticker
    await self.callback(TICKER, t, timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/feed.py", line 258, in callback
    await cb(obj, receipt_timestamp)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/leopard_py/crypto_feed/gateio/Subscribe_Market_Feed.py", line 23, in ticker
    todayChangePercent = Decimal(t.raw["result"]["'change_percentage'"])
KeyError: "'change_percentage'"
2022-12-25 18:33:03,807 : WARNING : GATEIO.ws.1: received no messages within timeout, restarting connection
2022-12-25 18:33:33,825 : WARNING : GATEIO.ws.1: encountered connection issue sent 1000 (OK); no close frame received - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 968, in transfer_data
    message = await self.read_message()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1038, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1113, in read_data_frame
    frame = await self.read_frame(max_size)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1170, in read_frame
    frame = await Frame.read(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/framing.py", line 69, in read
    data = await reader(2)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/streams.py", line 723, in readexactly
    await self._wait_for_data('readexactly')
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/streams.py", line 517, in _wait_for_data
    await self._waiter
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 115, in _handler
    async for message in connection.read():
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection.py", line 333, in read
    async for data in self.conn:
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 497, in __aiter__
    yield await self.recv()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 953, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: sent 1000 (OK); no close frame received
2022-12-25 18:38:38,194 : WARNING : GATEIO.ws.1: received no messages within timeout, restarting connection
2022-12-25 18:39:08,204 : WARNING : GATEIO.ws.1: encountered connection issue sent 1000 (OK); no close frame received - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 968, in transfer_data
    message = await self.read_message()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1038, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1113, in read_data_frame
    frame = await self.read_frame(max_size)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1170, in read_frame
    frame = await Frame.read(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/framing.py", line 69, in read
    data = await reader(2)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/streams.py", line 723, in readexactly
    await self._wait_for_data('readexactly')
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/streams.py", line 517, in _wait_for_data
    await self._waiter
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 115, in _handler
    async for message in connection.read():
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection.py", line 333, in read
    async for data in self.conn:
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 497, in __aiter__
    yield await self.recv()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 953, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: sent 1000 (OK); no close frame received
2022-12-25 18:44:22,493 : WARNING : GATEIO.ws.1: received no messages within timeout, restarting connection
2022-12-25 18:44:52,499 : WARNING : GATEIO.ws.1: encountered connection issue sent 1000 (OK); no close frame received - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 968, in transfer_data
    message = await self.read_message()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1038, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1113, in read_data_frame
    frame = await self.read_frame(max_size)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1170, in read_frame
    frame = await Frame.read(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/framing.py", line 69, in read
    data = await reader(2)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/streams.py", line 723, in readexactly
    await self._wait_for_data('readexactly')
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/streams.py", line 517, in _wait_for_data
    await self._waiter
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 115, in _handler
    async for message in connection.read():
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection.py", line 333, in read
    async for data in self.conn:
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 497, in __aiter__
    yield await self.recv()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 953, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: sent 1000 (OK); no close frame received
2022-12-25 18:49:46,819 : WARNING : GATEIO.ws.1: received no messages within timeout, restarting connection
2022-12-25 18:50:16,841 : WARNING : GATEIO.ws.1: encountered connection issue sent 1000 (OK); no close frame received - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 968, in transfer_data
    message = await self.read_message()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1038, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1113, in read_data_frame
    frame = await self.read_frame(max_size)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1170, in read_frame
    frame = await Frame.read(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/framing.py", line 69, in read
    data = await reader(2)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/streams.py", line 723, in readexactly
    await self._wait_for_data('readexactly')
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/streams.py", line 517, in _wait_for_data
    await self._waiter
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 115, in _handler
    async for message in connection.read():
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection.py", line 333, in read
    async for data in self.conn:
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 497, in __aiter__
    yield await self.recv()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 953, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: sent 1000 (OK); no close frame received
2022-12-25 18:55:21,135 : WARNING : GATEIO.ws.1: received no messages within timeout, restarting connection
2022-12-25 18:55:51,150 : WARNING : GATEIO.ws.1: encountered connection issue sent 1000 (OK); no close frame received - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 968, in transfer_data
    message = await self.read_message()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1038, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1113, in read_data_frame
    frame = await self.read_frame(max_size)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1170, in read_frame
    frame = await Frame.read(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/framing.py", line 69, in read
    data = await reader(2)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/streams.py", line 723, in readexactly
    await self._wait_for_data('readexactly')
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/streams.py", line 517, in _wait_for_data
    await self._waiter
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 115, in _handler
    async for message in connection.read():
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection.py", line 333, in read
    async for data in self.conn:
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 497, in __aiter__
    yield await self.recv()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 953, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: sent 1000 (OK); no close frame received
2022-12-25 19:00:55,518 : WARNING : GATEIO.ws.1: received no messages within timeout, restarting connection
2022-12-25 19:01:25,528 : WARNING : GATEIO.ws.1: encountered connection issue sent 1000 (OK); no close frame received - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 968, in transfer_data
    message = await self.read_message()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1038, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1113, in read_data_frame
    frame = await self.read_frame(max_size)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1170, in read_frame
    frame = await Frame.read(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/framing.py", line 69, in read
    data = await reader(2)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/streams.py", line 723, in readexactly
    await self._wait_for_data('readexactly')
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/streams.py", line 517, in _wait_for_data
    await self._waiter
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 115, in _handler
    async for message in connection.read():
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection.py", line 333, in read
    async for data in self.conn:
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 497, in __aiter__
    yield await self.recv()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 953, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: sent 1000 (OK); no close frame received
2022-12-25 19:06:29,892 : WARNING : GATEIO.ws.1: received no messages within timeout, restarting connection
2022-12-25 19:06:59,893 : WARNING : GATEIO.ws.1: encountered connection issue sent 1000 (OK); no close frame received - reconnecting in 1.0 seconds...
Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 968, in transfer_data
    message = await self.read_message()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1038, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1113, in read_data_frame
    frame = await self.read_frame(max_size)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 1170, in read_frame
    frame = await Frame.read(
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/framing.py", line 69, in read
    data = await reader(2)
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/streams.py", line 723, in readexactly
    await self._wait_for_data('readexactly')
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/streams.py", line 517, in _wait_for_data
    await self._waiter
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 69, in _create_connection
    await self._handler(connection, self.handler)
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection_handler.py", line 115, in _handler
    async for message in connection.read():
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/cryptofeed/connection.py", line 333, in read
    async for data in self.conn:
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 497, in __aiter__
    yield await self.recv()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/liuxin/Documents/workspace/python/leopard_py/venv/lib/python3.9/site-packages/websockets/legacy/protocol.py", line 953, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: sent 1000 (OK); no close frame received
